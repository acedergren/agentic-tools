# Hookify - Create Hooks from Conversation Analysis

The `/hookify` command helps you create hooks to prevent unwanted AI behaviors by analyzing conversations for mistakes or patterns you want to avoid.

## What is /hookify?

Hookify analyzes your conversation history with Claude to:
1. Identify behaviors you want to prevent
2. Suggest appropriate hooks to block those behaviors
3. Generate hook configuration and scripts

## When to Use /hookify

Use `/hookify` after experiencing:
- **Repeated mistakes** - Claude keeps making the same error
- **Unwanted actions** - Commands you want to block or validate
- **Missing validation** - Checks that should run before actions
- **Workflow violations** - Steps Claude should follow but doesn't

## Basic Usage

### Analyze Current Conversation

```
/hookify
```

This analyzes the current conversation and suggests hooks based on identified issues.

### Create Hook for Specific Behavior

```
/hookify "prevent git force push to main"
```

Claude will create a hook that blocks `git push --force` to the main branch.

## Example Scenarios

### 1. Prevent Force Push to Main

**Problem**: Claude accidentally ran `git push --force origin main`

**Command**:
```
/hookify "never allow force push to main branch"
```

**Generated Hook**:
```bash
#!/bin/bash
# Hook: Prevent force push to protected branches

if echo "$BASH_COMMAND" | grep -qE 'git push.*(--force|-f).*main'; then
  echo "‚ùå BLOCKED: Force push to main branch not allowed"
  exit 1
fi
```

### 2. Validate Test Before Commit

**Problem**: Claude committed code without running tests

**Command**:
```
/hookify "always run tests before git commit"
```

**Generated Hook**:
```bash
#!/bin/bash
# Hook: Run tests before commit

if echo "$BASH_COMMAND" | grep -q "git commit"; then
  echo "üß™ Running tests first..."
  npm test || exit 1
fi
```

### 3. Check for Secrets Before Commit

**Problem**: Almost committed an API key

**Command**:
```
/hookify "scan for secrets before committing"
```

**Generated Hook**:
```bash
#!/bin/bash
# Hook: Detect secrets in staged changes

if echo "$BASH_COMMAND" | grep -q "git commit"; then
  if git diff --cached | grep -iE '(api_key|password|secret)'; then
    echo "‚ùå Potential secret detected"
    exit 1
  fi
fi
```

### 4. Prevent Destructive Database Commands

**Problem**: Claude suggested `DROP DATABASE` in development

**Command**:
```
/hookify "block any DROP DATABASE commands"
```

**Generated Hook**:
```bash
#!/bin/bash
# Hook: Block destructive database operations

if echo "$BASH_COMMAND" | grep -iE '(DROP|TRUNCATE) (DATABASE|TABLE)'; then
  echo "‚ùå BLOCKED: Destructive database operation"
  exit 1
fi
```

### 5. Require Code Review Comment

**Problem**: Created PR without description

**Command**:
```
/hookify "enforce PR description minimum length"
```

**Generated Hook**:
```bash
#!/bin/bash
# Hook: Validate PR description length

if echo "$BASH_COMMAND" | grep -q "gh pr create"; then
  # Extract description from command
  if ! echo "$BASH_COMMAND" | grep -qE '--body.{50,}'; then
    echo "‚ùå PR description too short (minimum 50 characters)"
    exit 1
  fi
fi
```

## Hook Types Generated by /hookify

Hookify can create different hook types based on the behavior:

| Behavior Pattern | Hook Type | Example |
|-----------------|-----------|---------|
| Bash command validation | `bash-pre` | Block dangerous commands |
| Pre-commit checks | `bash-pre` (filtered) | Run tests before commit |
| File modification rules | `edit-pre`, `write-pre` | Validate file templates |
| Session workflows | `session-start`, `session-end` | Setup/cleanup |
| Cost controls | `user-prompt-submit` | Rate limiting |

## Configuration

After running `/hookify`, Claude will:

1. **Generate the hook script** in `.claude/hooks/`
2. **Update settings** to enable the hook
3. **Test the hook** to verify it works

Example configuration added to `.claude/settings.local.json`:

```json
{
  "hooks": {
    "bash-pre": {
      "command": ".claude/hooks/hookify.force-push-safety.local.sh",
      "blocking": true,
      "description": "Prevent force push to main branch"
    }
  }
}
```

## Advanced Patterns

### Multiple Conditions

```
/hookify "block force push to main OR develop branches"
```

Generates hook checking multiple branch names.

### Environment-Specific

```
/hookify "only allow npm publish in CI environment"
```

Generates hook checking for CI environment variable.

### Approval Workflow

```
/hookify "require manual approval for rm -rf commands"
```

Generates interactive hook prompting for confirmation.

## Hook Naming Convention

Hookify uses this naming pattern:

```
.claude/hooks/hookify.<behavior-slug>.<scope>.sh
```

**Examples:**
- `hookify.force-push-safety.local.sh` - Local project hook
- `hookify.commit-preflight.local.sh` - Pre-commit validation
- `hookify.destructive-git-ops.local.sh` - Prevent destructive ops

**Scope**:
- `.local.sh` - Project-specific hook
- `.global.sh` - User-level hook (applies to all projects)

## Disabling Hookify Hooks

### Temporary Disable

```bash
# Set environment variable
export CLAUDE_HOOKIFY_DISABLED=true
```

### Permanent Disable

Remove hook from `.claude/settings.local.json`:

```json
{
  "hooks": {
    "bash-pre": {
      "command": ".claude/hooks/hookify.force-push-safety.local.sh",
      "blocking": true
    }
  }
}
```

### Delete Hook

```bash
rm .claude/hooks/hookify.force-push-safety.local.sh
```

## Best Practices

### 1. Be Specific

‚ùå **Too vague**: "/hookify prevent mistakes"
‚úÖ **Specific**: "/hookify prevent force push to protected branches"

### 2. Test Hooks

After hookify creates a hook:
```bash
# Test the hook manually
.claude/hooks/hookify.test.sh "git push --force origin main"
```

### 3. Document Intent

Hookify adds comments to hooks explaining:
- What behavior it prevents
- Why it was created (conversation context)
- Example of blocked commands

### 4. Review Generated Code

Always review the generated hook script to ensure:
- Correct pattern matching
- No false positives
- Clear error messages

### 5. Start Permissive

Begin with warnings, not blocks:
```bash
# Warn instead of block
echo "‚ö†Ô∏è WARNING: This action needs review"
# Return 0 to allow
```

Later, change to blocking if needed.

## Common Hookify Patterns

### Git Safety

```
/hookify "prevent force push to main"
/hookify "always run tests before commit"
/hookify "block commits to main without PR"
/hookify "require sign-off for commits"
```

### Security

```
/hookify "scan for secrets before commit"
/hookify "block API keys in code"
/hookify "validate SSL certificates"
/hookify "prevent sudo without confirmation"
```

### Quality Gates

```
/hookify "run linter before commit"
/hookify "check code coverage threshold"
/hookify "validate commit message format"
/hookify "ensure tests exist for new code"
```

### Cost Control

```
/hookify "limit API calls to 100 per hour"
/hookify "warn when daily cost exceeds $10"
/hookify "block expensive operations after hours"
```

## Troubleshooting

### Hook Not Triggering

Check:
1. Hook has execute permissions: `chmod +x .claude/hooks/hookify.*.sh`
2. Hook is enabled in settings
3. `blocking: true` for pre-hooks that should prevent actions
4. Pattern matching is correct (test with sample input)

### False Positives

Refine the pattern:
```bash
# Too broad
if echo "$COMMAND" | grep -q "rm"; then

# More specific
if echo "$COMMAND" | grep -qE 'rm -rf (/|~|\*)'; then
```

### Hook Fails to Execute

Enable debug logging:
```json
{
  "logging": {
    "hooks": "debug"
  }
}
```

Check logs:
```bash
tail -f ~/.claude/logs/hooks.log
```

## See Also

- [examples/](examples/) - Pre-built hook examples
- [hook-templates/](hook-templates/) - Starter templates
- [README.md](README.md) - Hook documentation
- [Claude Code Hooks Docs](https://docs.anthropic.com/claude-code/hooks)

---

**Pro Tip**: Run `/hookify` regularly after sessions where you notice repeated mistakes. This builds up a library of safety checks tailored to your workflow.
